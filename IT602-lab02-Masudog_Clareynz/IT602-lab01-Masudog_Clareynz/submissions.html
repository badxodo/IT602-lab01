<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CJ - Message Submissions</title>
  <link rel="icon" type="image/png" href="Logo.png">
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;900&family=Gabarito:wght@900&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      opacity: 0;
      animation: fadeIn 0.8s ease-in forwards;
    }
    
    @keyframes fadeIn {
      to {
        opacity: 1;
      }
    }
    
    @keyframes slideDown {
      from {
        transform: translateY(-50px);
        opacity: 0;
      }
      to {
        transform: translateY(0);
        opacity: 1;
      }
    }
    
    @keyframes fadeInUp {
      from {
        transform: translateY(30px);
        opacity: 0;
      }
      to {
        transform: translateY(0);
        opacity: 1;
      }
    }
    
    header {
      animation: slideDown 0.8s ease-out 0.2s forwards;
      opacity: 0;
    }
    
    .mb-8.flex {
      animation: fadeInUp 0.8s ease-out 0.4s forwards;
      opacity: 0;
    }
    
    .bg-white.border-2 {
      animation: fadeInUp 1s ease-out 0.6s forwards;
      opacity: 0;
    }
    
    .refresh-hover:hover, .back-hover:hover {
      background-color: #991B1B !important;
    }
    #clear-all:hover {
      background-color: #000000 !important;
    }
    .delete-btn:hover {
      color: #000000 !important;
    }
    td a:hover {
      color: #000000 !important;
      text-decoration: underline;
    }
    
    /* Dark mode styles */
    body.dark-mode {
      background-color: #1a1a1a;
      color: #ffffff;
    }
    
    body.dark-mode .bg-white {
      background-color: #1a1a1a;
    }
    
    body.dark-mode .border-black {
      border-color: #ffffff;
    }
    
    body.dark-mode .text-black {
      color: #ffffff;
    }
    
    body.dark-mode .text-gray-600 {
      color: #cccccc;
    }
    
    body.dark-mode .text-gray-500 {
      color: #999999;
    }
    
    body.dark-mode .bg-black {
      background-color: #2a2a2a;
    }
    
    body.dark-mode thead tr {
      background-color: #2a2a2a !important;
    }
    
    body.dark-mode .divide-gray-200 > * {
      border-color: #444444 !important;
    }
    
    body.dark-mode .hover\:bg-red-50:hover {
      background-color: rgba(153, 27, 27, 0.2) !important;
    }
    
    body.dark-mode .text-gray-300 {
      color: #666666;
    }
    
    /* Smooth transitions */
    body, .bg-white, .border-black, .text-black, .bg-black, thead tr {
      transition: all 0.5s ease;
    }
    
    /* Theme Switch Styles */
    .theme-switch-wrapper {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .theme-switch {
      position: relative;
      display: inline-block;
      width: 60px;
      height: 30px;
      flex-shrink: 0;
    }
    
    .theme-switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }
    
    .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #FDB813;
      transition: 0.4s;
      border-radius: 34px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 8px;
    }
    
    .slider-icon {
      font-size: 14px;
      z-index: 1;
      transition: opacity 0.3s;
      color: #fff;
    }
    
    .light-icon {
      opacity: 1;
    }
    
    .dark-icon {
      opacity: 0;
    }
    
    .slider:before {
      position: absolute;
      content: "";
      height: 24px;
      width: 24px;
      left: 3px;
      bottom: 3px;
      background-color: white;
      transition: 0.4s;
      border-radius: 50%;
      z-index: 2;
    }
    
    input:checked + .slider {
      background-color: #1a1a2e;
    }
    
    input:checked + .slider .light-icon {
      opacity: 0;
    }
    
    input:checked + .slider .dark-icon {
      opacity: 1;
    }
    
    input:checked + .slider:before {
      transform: translateX(30px);
    }
    
    .theme-text {
      font-size: 14px;
      font-weight: 600;
      color: #000;
      min-width: 45px;
      transition: color 0.3s;
    }
    
    body.dark-mode .theme-text {
      color: #fff;
    }
  </style>
</head>

<body class="bg-white p-6 md:p-12">

  <section class="max-w-7xl mx-auto">
    <!-- Header with Back Button -->
    <header class="mb-12 flex items-center justify-between flex-wrap gap-4">
      <div>
        <h1 class="text-5xl font-black tracking-tight mb-3 max-[700px]:text-4xl" style="font-family: 'Gabarito', sans-serif; color: #991B1B; text-shadow: 2px 2px rgba(0, 0, 0, 0.5);">
          Submissions Archive
        </h1>
        <p class="text-lg" style="font-family: 'Poppins', sans-serif; color: #1F2937;">Review all contact form entries</p>
      </div>
      <div class="flex items-center gap-4 flex-wrap">
        <!-- Dark Mode Switch -->
        <div class="theme-switch-wrapper">
          <label class="theme-switch">
            <input type="checkbox" id="theme-toggle">
            <span class="slider">
              <i class="fas fa-sun slider-icon light-icon"></i>
              <i class="fas fa-moon slider-icon dark-icon"></i>
            </span>
          </label>
          <span class="theme-text">Light</span>
        </div>
        
        <a href="index.html" class="flex items-center gap-3 px-6 py-3 bg-black text-white transition-colors font-bold shadow-lg back-hover rounded-xl whitespace-nowrap" style="font-family: 'Poppins', sans-serif;">
          <i class="fas fa-arrow-left"></i>
          <span>BACK</span>
        </a>
      </div>
    </header>

    <!-- Controls -->
    <div class="mb-8 flex flex-wrap gap-4 items-center justify-between">
      <div class="flex items-center gap-4">
        <button id="clear-all" class="px-6 py-3 text-white hover:bg-black transition-colors flex items-center gap-2 font-bold shadow-lg rounded-xl" style="font-family: 'Poppins', sans-serif; background-color: #991B1B;">
          <i class="fas fa-trash"></i>
          <span>CLEAR ALL</span>
        </button>
        <span id="count-display" class="text-black font-bold text-lg" style="font-family: 'Poppins', sans-serif;"></span>
      </div>
      <button id="refresh-btn" class="px-6 py-3 bg-black text-white transition-colors flex items-center gap-2 font-bold shadow-lg refresh-hover rounded-xl" style="font-family: 'Poppins', sans-serif;">
        <i class="fas fa-sync"></i>
        <span>REFRESH</span>
      </button>
    </div>

    <!-- Table Container -->
    <div class="bg-white border-2 border-black shadow-xl overflow-hidden rounded-2xl">
      <div class="overflow-x-auto">
        <table class="w-full text-left border-collapse" style="font-family: 'Poppins', sans-serif;">
          <thead>
            <tr class="bg-black border-b-2 border-black">
              <th class="px-6 py-4 text-xs font-black text-white uppercase tracking-wider">#</th>
              <th class="px-6 py-4 text-xs font-black text-white uppercase tracking-wider">Date & Time</th>
              <th class="px-6 py-4 text-xs font-black text-white uppercase tracking-wider">Name</th>
              <th class="px-6 py-4 text-xs font-black text-white uppercase tracking-wider">Email</th>
              <th class="px-6 py-4 text-xs font-black text-white uppercase tracking-wider">Message</th>
              <th class="px-6 py-4 text-xs font-black text-white uppercase tracking-wider">Actions</th>
            </tr>
          </thead>
          <tbody id="submissions-list" class="divide-y-2 divide-gray-200">
            <!-- Submissions will be loaded here -->
          </tbody>
        </table>
      </div>
      
      <!-- Empty State -->
      <div id="empty-state" class="hidden py-20 text-center">
        <i class="fas fa-inbox text-6xl text-gray-300 mb-4"></i>
        <p class="text-gray-600 text-xl font-bold" style="font-family: 'Poppins', sans-serif;">No submissions yet</p>
        <p class="text-gray-500 text-sm mt-2" style="font-family: 'Poppins', sans-serif;">Contact form entries will appear here</p>
      </div>
    </div>
  </section>

  <script>
    // Apply saved theme immediately before page loads
    (function() {
      const currentTheme = localStorage.getItem('theme') || 'light';
      if (currentTheme === 'dark') {
        document.body.classList.add('dark-mode');
      }
    })();
    
    function viewSubmissions() {
      const list = document.getElementById('submissions-list');
      const emptyState = document.getElementById('empty-state');
      const countDisplay = document.getElementById('count-display');
      const data = JSON.parse(localStorage.getItem('contact_submissions')) || [];

      if (data.length === 0) {
        list.innerHTML = '';
        emptyState.classList.remove('hidden');
        countDisplay.textContent = 'No submissions';
        return;
      }

      emptyState.classList.add('hidden');
      countDisplay.textContent = `Total: ${data.length} ${data.length === 1 ? 'submission' : 'submissions'}`;

      list.innerHTML = data.reverse().map((entry, index) => `
        <tr class="hover:bg-red-50 transition-colors table-row-hover">
          <td class="px-6 py-4 text-sm font-bold text-black">${data.length - index}</td>
          <td class="px-6 py-4 text-xs font-mono text-gray-600 whitespace-nowrap">${escapeHtml(entry.submittedAt)}</td>
          <td class="px-6 py-4 font-bold text-black">${escapeHtml(entry.name)}</td>
          <td class="px-6 py-4">
            <a href="mailto:${escapeHtml(entry.email)}" class="font-semibold" style="color: #991B1B;">
              ${escapeHtml(entry.email)}
            </a>
          </td>
          <td class="px-6 py-4 text-black max-w-md">
            <div class="line-clamp-2">${escapeHtml(entry.message)}</div>
          </td>
          <td class="px-6 py-4">
            <button onclick="deleteSubmission(${data.length - index - 1})" 
                    class="transition font-bold delete-btn" style="color: #991B1B;">
              <i class="fas fa-trash"></i>
            </button>
          </td>
        </tr>
      `).join('');
    }

    function escapeHtml(text) {
      const div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML;
    }

    function deleteSubmission(index) {
      if (confirm('Delete this submission permanently?')) {
        const data = JSON.parse(localStorage.getItem('contact_submissions')) || [];
        data.splice(index, 1);
        localStorage.setItem('contact_submissions', JSON.stringify(data));
        viewSubmissions();
      }
    }

    function clearAllSubmissions() {
      if (confirm('Delete ALL submissions? This cannot be undone.')) {
        localStorage.removeItem('contact_submissions');
        viewSubmissions();
      }
    }

    // Event listeners
    document.addEventListener('DOMContentLoaded', () => {
      viewSubmissions();

      document.getElementById('clear-all').addEventListener('click', clearAllSubmissions);
      document.getElementById('refresh-btn').addEventListener('click', viewSubmissions);
      
      // Theme Toggle Functionality
      const themeToggle = document.getElementById('theme-toggle');
      const themeText = document.querySelector('.theme-text');
      const body = document.body;

      // Check for saved theme preference or default to light mode
      const currentTheme = localStorage.getItem('theme') || 'light';
      if (currentTheme === 'dark') {
        body.classList.add('dark-mode');
        themeToggle.checked = true;
        themeText.textContent = 'Dark';
      }

      themeToggle.addEventListener('change', () => {
        body.classList.toggle('dark-mode');
        
        const isDark = body.classList.contains('dark-mode');
        themeText.textContent = isDark ? 'Dark' : 'Light';
        
        if (isDark) {
          localStorage.setItem('theme', 'dark');
        } else {
          localStorage.setItem('theme', 'light');
        }
      });
    });
  </script>

</body>
</html>